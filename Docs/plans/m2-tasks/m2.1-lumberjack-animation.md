---
title: "M2.1 벌목꾼 애니메이션 & 이펙트"
type: feat
date: 2026-01-27
milestone: M2
task_id: M2.1
depends_on: [M1]
scripts: 3
---

# M2.1: 벌목꾼 애니메이션 & 이펙트

## 목표

벌목꾼의 시각적 피드백을 강화합니다.
Idle/Walk/Attack 애니메이션과 소환 이펙트를 구현합니다.

## 의존성

- **M1**: 프로토타입 완료 필수 (LumberjackController 존재)

## 구현할 스크립트

### 1. LumberjackAnimator.cs

```
Assets/02.Scripts/Lumberjack/LumberjackAnimator.cs
```

**역할:** 벌목꾼 애니메이션 제어

**주요 기능:**
- 상태에 따른 애니메이션 전환
- 타격 타이밍 이벤트 발생
- 애니메이션 속도 조절 (업그레이드 연동)

**인터페이스:**
```csharp
public class LumberjackAnimator : MonoBehaviour
{
    // 애니메이션 상태
    public void PlayIdle();
    public void PlayWalk();
    public void PlayAttack();

    // 이벤트
    public event Action OnAttackHit;  // 타격 타이밍

    // 속도 조절
    public void SetAnimationSpeed(float speed);
}
```

**Animator 파라미터:**
| 파라미터 | 타입 | 설명 |
|----------|------|------|
| IsWalking | Bool | 걷기 상태 |
| Attack | Trigger | 공격 트리거 |
| Speed | Float | 애니메이션 속도 |

**Animator 상태 머신:**
```
Entry → Idle
Idle ↔ Walk (IsWalking)
Idle/Walk → Attack (Attack trigger)
Attack → Idle/Walk
```

### 2. SpawnEffect.cs

```
Assets/02.Scripts/Effects/SpawnEffect.cs
```

**역할:** 벌목꾼 소환 시 시각적 연출

**주요 기능:**
- 소환 시 스케일 애니메이션 (0 → 1)
- 먼지 파티클 발생
- 소환 완료 이벤트

**인터페이스:**
```csharp
public class SpawnEffect : MonoBehaviour
{
    [SerializeField] private float _spawnDuration = 0.5f;
    [SerializeField] private AnimationCurve _scaleCurve;
    [SerializeField] private ParticleSystem _dustParticle;

    public event Action OnSpawnComplete;

    public void PlaySpawnAnimation();
}
```

### 3. EnhancedParticleSpawner.cs

```
Assets/02.Scripts/Effects/EnhancedParticleSpawner.cs
```

**역할:** 기존 파티클 시스템 강화

**주요 기능:**
- 나무조각 파티클 개선
- 잎사귀 파티클 개선
- 파티클 풀링 강화
- 타격 위치 기반 발생

**인터페이스:**
```csharp
public class EnhancedParticleSpawner : MonoBehaviour
{
    public void SpawnWoodChips(Vector3 position, Vector3 direction, int count);
    public void SpawnLeaves(Vector3 position, int count);
    public void SpawnCriticalEffect(Vector3 position);
}
```

## 기존 코드 수정

### LumberjackController.cs 수정

```csharp
public class LumberjackController : MonoBehaviour
{
    // 기존 필드...
    private LumberjackAnimator _animator;

    private void Awake()
    {
        _animator = GetComponent<LumberjackAnimator>();
    }

    private void Update()
    {
        switch (_currentState)
        {
            case State.Idle:
                _animator?.PlayIdle();
                FindTree();
                break;
            case State.Moving:
                _animator?.PlayWalk();
                MoveToTree();
                break;
            case State.Attacking:
                Attack();
                break;
        }
    }

    private void Attack()
    {
        // 타격 타이밍 시 애니메이션 트리거
        if (_attackTimer >= _attackInterval)
        {
            _animator?.PlayAttack();
            // 실제 데미지는 애니메이션 이벤트에서 처리
        }
    }

    // 애니메이션 이벤트에서 호출
    public void OnAttackHit()
    {
        // 데미지 처리...
    }
}
```

### LumberjackSpawner.cs 수정

```csharp
public LumberjackController SpawnLumberjack()
{
    // 기존 로직...

    // 스폰 이펙트 적용
    var spawnEffect = obj.GetComponent<SpawnEffect>();
    spawnEffect?.PlaySpawnAnimation();

    return controller;
}
```

## 애니메이션 스펙

### Idle 애니메이션
- 길이: 1-2초 (루프)
- 동작: 가벼운 호흡, 좌우 살펴보기
- FPS: 12-24

### Walk 애니메이션
- 길이: 0.5-1초 (루프)
- 동작: 도끼 들고 걷기
- FPS: 24

### Attack 애니메이션
- 길이: 0.5-0.8초
- 동작: 도끼 휘두르기
- 타격 프레임: 전체의 60-70% 지점
- FPS: 24-30

## 체크리스트

### 구현

- [ ] LumberjackAnimator 구현
- [ ] Animator Controller 설정
- [ ] 상태 전환 로직 연동
- [ ] SpawnEffect 구현
- [ ] EnhancedParticleSpawner 구현

### 애니메이션

- [ ] Idle 애니메이션 적용
- [ ] Walk 애니메이션 적용
- [ ] Attack 애니메이션 적용
- [ ] 애니메이션 이벤트 설정

### 이펙트

- [ ] 소환 스케일 애니메이션
- [ ] 소환 먼지 파티클
- [ ] 나무조각 파티클 개선
- [ ] 잎사귀 파티클 개선

### 테스트

- [ ] 상태 전환 자연스러움 확인
- [ ] 타격 타이밍 정확도 확인
- [ ] 파티클 풀링 동작 확인
- [ ] 다수 벌목꾼 성능 테스트

## 에셋 요구사항

### 필수
- 벌목꾼 3D 모델 (리깅 완료)
- Idle/Walk/Attack 애니메이션 클립

### 대체 방안 (에셋 없을 경우)
- 프로그래밍 애니메이션으로 대체
- DOTween 활용한 스케일/로테이션 애니메이션
- 간단한 도끼 휘두르기 모션

## 폴더 구조

```
Assets/
├── 02.Scripts/
│   ├── Lumberjack/
│   │   └── LumberjackAnimator.cs
│   └── Effects/
│       ├── SpawnEffect.cs
│       └── EnhancedParticleSpawner.cs
├── Animations/
│   └── Lumberjack/
│       ├── LumberjackAnimatorController.controller
│       ├── Lumberjack_Idle.anim
│       ├── Lumberjack_Walk.anim
│       └── Lumberjack_Attack.anim
└── Prefabs/
    └── Effects/
        ├── SpawnDust.prefab
        └── WoodChips_Enhanced.prefab
```

## 다음 단계

M2.1 완료 후:
→ M2.4 통합 테스트에서 전체 시각 피드백 검증
